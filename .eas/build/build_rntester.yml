build:
  name: Build RNTester artifacts
  steps:
    - eas/checkout
    - eas/install_node_modules
    - install_cmake
    - run:
        name: Install Ruby
        command: |
          ./scripts/install-ruby.sh
    - run:
        name: Install Java and Android SDK
        command: |
          ./scripts/install-android-sdk.sh
    - run:
        name: Build React Native iOS Maven artifacts
        command: |
          ./src/build-ios-artifacts.ts
    - run:
        name: Create Maven artifact tarball
        command: |
          ./src/process-maven-artifacts.ts
    - run:
        name: Build RNTester apps using Maven tarball
        command: |
          ./src/build-rntester-apps.ts
    - eas/upload_artifact:
        name: Upload RNTester artifacts
        inputs:
          type: build-artifact
          path: |
            maven_artifacts/*.tgz

functions:
  install_cmake:
    name: Install Cmake
    path: ./installCmake
